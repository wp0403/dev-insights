---
title: 'ä½¿ç”¨ Next.js æ­å»ºä¸ªäººåšå®¢ï¼šä»é›¶åˆ°éƒ¨ç½²çš„å®Œæ•´æŒ‡å—'
date: '2024-03-14'
description: 'è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨ Next.js å’Œ MDX æ­å»ºä¸€ä¸ªç°ä»£åŒ–çš„ä¸ªäººåšå®¢ç³»ç»Ÿï¼ŒåŒ…å«ä»ç¯å¢ƒé…ç½®åˆ°æœ€ç»ˆéƒ¨ç½²çš„å…¨æµç¨‹'
tags: ['Next.js', 'React', 'MDX', 'å…¨æ ˆå¼€å‘']
---

# ä½¿ç”¨ Next.js æ­å»ºä¸ªäººåšå®¢ï¼šä»é›¶åˆ°éƒ¨ç½²çš„å®Œæ•´æŒ‡å—

åœ¨å½“ä»Šæ•°å­—æ—¶ä»£ï¼Œæ‹¥æœ‰ä¸€ä¸ªä¸ªäººåšå®¢ä¸ä»…æ˜¯å±•ç¤ºä¸“ä¸šæŠ€èƒ½çš„çª—å£ï¼Œæ›´æ˜¯åˆ†äº«çŸ¥è¯†ã€å»ºç«‹ä¸ªäººå“ç‰Œçš„é‡è¦å¹³å°ã€‚Next.js ä½œä¸ºä¸€ä¸ªå¼ºå¤§çš„ React æ¡†æ¶ï¼Œæä¾›äº†æ„å»ºç°ä»£åŒ–ç½‘ç«™æ‰€éœ€çš„ä¸€åˆ‡åŠŸèƒ½ã€‚æœ¬æ–‡å°†å¸¦ä½ ä¸€æ­¥æ­¥æ­å»ºä¸€ä¸ªåŠŸèƒ½å®Œå–„çš„ä¸ªäººåšå®¢ç³»ç»Ÿã€‚

## ä¸ºä»€ä¹ˆé€‰æ‹© Next.jsï¼Ÿ

Next.js ç›¸æ¯”å…¶ä»–æ¡†æ¶å…·æœ‰æ˜¾è‘—ä¼˜åŠ¿ï¼š

- **æœåŠ¡å™¨ç«¯æ¸²æŸ“(SSR)å’Œé™æ€ç«™ç‚¹ç”Ÿæˆ(SSG)**ï¼šæä¾›æ›´å¥½çš„æ€§èƒ½å’ŒSEO
- **æ–‡ä»¶ç³»ç»Ÿè·¯ç”±**ï¼šç›´è§‚ä¸”æ˜“äºç»´æŠ¤
- **è‡ªåŠ¨ä»£ç åˆ†å‰²**ï¼šä¼˜åŒ–åŠ è½½é€Ÿåº¦
- **å†…ç½®å›¾åƒä¼˜åŒ–**ï¼šæä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ
- **API è·¯ç”±**ï¼šè½»æ¾æ„å»ºåç«¯åŠŸèƒ½
- **é›¶é…ç½®**ï¼šå¼€ç®±å³ç”¨çš„å¼€å‘ä½“éªŒ

## ç¯å¢ƒå‡†å¤‡

åœ¨å¼€å§‹ä¹‹å‰ï¼Œç¡®ä¿ä½ çš„ç³»ç»Ÿå·²å®‰è£…ï¼š

```bash
# æ£€æŸ¥ Node.js ç‰ˆæœ¬ï¼ˆæ¨è v18+ï¼‰
node -v

# æ£€æŸ¥åŒ…ç®¡ç†å™¨
npm -v  # æˆ– yarn -v æˆ– pnpm -v
```

## é¡¹ç›®åˆå§‹åŒ–

ä½¿ç”¨ create-next-app å¿«é€Ÿåˆ›å»ºé¡¹ç›®ï¼š

```bash
npx create-next-app@latest my-blog --typescript --eslint --tailwind --app
cd my-blog
```

è¿™ä¸ªå‘½ä»¤ä¼šåˆ›å»ºä¸€ä¸ªä½¿ç”¨ TypeScriptã€ESLintã€Tailwind CSS å’Œ App Router çš„ Next.js é¡¹ç›®ã€‚

## æ·»åŠ  MDX æ”¯æŒ

MDX å…è®¸æˆ‘ä»¬åœ¨ Markdown ä¸­ä½¿ç”¨ React ç»„ä»¶ï¼Œæ˜¯åšå®¢å†…å®¹ç®¡ç†çš„ç†æƒ³é€‰æ‹©ï¼š

```bash
npm install contentlayer next-contentlayer date-fns
```

åˆ›å»º `contentlayer.config.ts` æ–‡ä»¶ï¼š

```typescript
import { defineDocumentType, makeSource } from 'contentlayer/source-files'
import { compareDesc } from 'date-fns'

export const Post = defineDocumentType(() => ({
  name: 'Post',
  filePathPattern: `**/*.mdx`,
  contentType: 'mdx',
  fields: {
    title: { type: 'string', required: true },
    date: { type: 'date', required: true },
    description: { type: 'string', required: true },
    tags: { type: 'list', of: { type: 'string' }, required: true }
  },
  computedFields: {
    url: { type: 'string', resolve: (post) => `/posts/${post._raw.flattenedPath}` },
  },
}))

export default makeSource({ contentDirPath: 'posts', documentTypes: [Post] })
```

## åˆ›å»ºåšå®¢å¸ƒå±€å’Œç»„ä»¶

è®¾è®¡ä¸€ä¸ªæ¸…æ™°çš„ç›®å½•ç»“æ„ï¼š

```
src/
  app/
    layout.tsx      # ä¸»å¸ƒå±€
    page.tsx        # é¦–é¡µ
    posts/
      [slug]/
        page.tsx    # æ–‡ç« é¡µé¢
      page.tsx      # æ–‡ç« åˆ—è¡¨é¡µ
  components/
    Header.tsx      # é¡µå¤´
    Footer.tsx      # é¡µè„š
    PostCard.tsx    # æ–‡ç« å¡ç‰‡
```

## å®ç°æ–‡ç« åˆ—è¡¨å’Œè¯¦æƒ…é¡µ

é¦–é¡µæ–‡ç« åˆ—è¡¨å®ç°ç¤ºä¾‹ï¼š

```typescript
import { allPosts } from 'contentlayer/generated'
import { compareDesc } from 'date-fns'
import PostCard from '@/components/PostCard'

export default function Home() {
  const posts = allPosts.sort((a, b) =>
    compareDesc(new Date(a.date), new Date(b.date))
  )

  return (
    <main className="container mx-auto px-4 py-8">
      <h1 className="text-3xl font-bold mb-8">æœ€æ–°æ–‡ç« </h1>
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {posts.map((post) => (
          <PostCard key={post._id} post={post} />
        ))}
      </div>
    </main>
  )
}
```

## æ·»åŠ é«˜çº§åŠŸèƒ½

### 1. å®ç°æ ‡ç­¾è¿‡æ»¤ç³»ç»Ÿ

```typescript
// components/TagFilter.tsx
export default function TagFilter({ tags, activeTag, onChange }) {
  return (
    <div className="flex flex-wrap gap-2 my-4">
      <button
        className={`px-3 py-1 rounded ${!activeTag ? 'bg-blue-500 text-white' : 'bg-gray-200'}`}
        onClick={() => onChange(null)}
      >
        å…¨éƒ¨
      </button>
      {tags.map(tag => (
        <button
          key={tag}
          className={`px-3 py-1 rounded ${activeTag === tag ? 'bg-blue-500 text-white' : 'bg-gray-200'}`}
          onClick={() => onChange(tag)}
        >
          {tag}
        </button>
      ))}
    </div>
  )
}
```

### 2. æ·»åŠ æœç´¢åŠŸèƒ½

```typescript
// components/SearchBar.tsx
export default function SearchBar({ onSearch }) {
  return (
    <div className="relative mb-6">
      <input
        type="text"
        placeholder="æœç´¢æ–‡ç« ..."
        className="w-full p-2 border rounded-lg"
        onChange={(e) => onSearch(e.target.value)}
      />
      <svg className="absolute right-3 top-3 h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
      </svg>
    </div>
  )
}
```

### 3. æ·»åŠ æš—è‰²æ¨¡å¼

```typescript
// components/ThemeToggle.tsx
'use client'

import { useState, useEffect } from 'react'

export default function ThemeToggle() {
  const [darkMode, setDarkMode] = useState(false)

  useEffect(() => {
    if (darkMode) {
      document.documentElement.classList.add('dark')
    } else {
      document.documentElement.classList.remove('dark')
    }
  }, [darkMode])

  return (
    <button
      onClick={() => setDarkMode(!darkMode)}
      className="p-2 rounded-lg bg-gray-200 dark:bg-gray-800"
    >
      {darkMode ? 'ğŸŒ' : 'ğŸŒ™'}
    </button>
  )
}
```

## éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

### Vercel éƒ¨ç½²ï¼ˆæ¨èï¼‰

1. å°†ä»£ç æ¨é€åˆ° GitHub ä»“åº“
2. åœ¨ Vercel ä¸­å¯¼å…¥é¡¹ç›®
3. é…ç½®ç¯å¢ƒå˜é‡ï¼ˆå¦‚éœ€è¦ï¼‰
4. ç‚¹å‡»éƒ¨ç½²

### å…¶ä»–éƒ¨ç½²é€‰é¡¹

- **Netlify**ï¼šç±»ä¼¼ Vercel çš„éƒ¨ç½²æµç¨‹
- **è‡ªæ‰˜ç®¡**ï¼šä½¿ç”¨ `next build` å’Œ `next start` å‘½ä»¤

## æ€§èƒ½ä¼˜åŒ–æŠ€å·§

1. **å›¾ç‰‡ä¼˜åŒ–**ï¼šä½¿ç”¨ Next.js çš„ Image ç»„ä»¶
2. **ä»£ç åˆ†å‰²**ï¼šä½¿ç”¨åŠ¨æ€å¯¼å…¥
3. **é¢„å–é“¾æ¥**ï¼šä½¿ç”¨ `next/link` çš„ prefetch åŠŸèƒ½
4. **ç¼“å­˜æ§åˆ¶**ï¼šé…ç½®é€‚å½“çš„ç¼“å­˜ç­–ç•¥

## ä¸‹ä¸€æ­¥è®¡åˆ’

1. æ·»åŠ è¯„è®ºç³»ç»Ÿï¼ˆå¯è€ƒè™‘ Giscusã€Disqus ç­‰ï¼‰
2. å®ç°æ•°æ®åˆ†æï¼ˆGoogle Analytics æˆ–è‡ªå®šä¹‰è§£å†³æ–¹æ¡ˆï¼‰
3. æ·»åŠ å›½é™…åŒ–æ”¯æŒ
4. å®ç° RSS è®¢é˜…åŠŸèƒ½
5. é›†æˆé‚®ä»¶è®¢é˜…ç³»ç»Ÿ

## ç»“è¯­

é€šè¿‡æœ¬æŒ‡å—ï¼Œä½ å·²ç»æŒæ¡äº†ä½¿ç”¨ Next.js æ„å»ºä¸ªäººåšå®¢çš„å®Œæ•´æµç¨‹ã€‚è¿™ä¸ä»…æ˜¯ä¸€ä¸ªå±•ç¤ºä½ æŠ€æœ¯èƒ½åŠ›çš„å¹³å°ï¼Œæ›´æ˜¯æŒç»­å­¦ä¹ å’Œåˆ†äº«çš„ç©ºé—´ã€‚éšç€ä½ çš„åšå®¢å†…å®¹ä¸æ–­ä¸°å¯Œï¼Œå¯ä»¥é€æ­¥æ·»åŠ æ›´å¤šåŠŸèƒ½ï¼Œæ‰“é€ å±äºè‡ªå·±çš„ç‹¬ç‰¹ç½‘ç»œç©ºé—´ã€‚

è®°ä½ï¼Œæœ€å¥½çš„åšå®¢ä¸ä»…ä»…æ˜¯æŠ€æœ¯çš„å±•ç¤ºï¼Œæ›´æ˜¯ä»·å€¼çš„ä¼ é€’ã€‚å®šæœŸæ›´æ–°é«˜è´¨é‡çš„å†…å®¹ï¼Œä¸è¯»è€…çœŸè¯šäº’åŠ¨ï¼Œä½ çš„åšå®¢ç»ˆå°†æˆä¸ºä½ èŒä¸šå‘å±•é“è·¯ä¸Šçš„é‡è¦èµ„äº§ã€‚